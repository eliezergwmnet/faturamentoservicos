@model List<Portal.BE.Chamado.ChamadoBE>
@{
    var dados = Model;
    string mensagem = "";
}

<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Numero</th>
            <th>Cliente</th>
            <th>Status</th>
            <th>Catgoria</th>
            <th>Ult. Mensagem</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in dados)
        {
            if (item.Mensagens.Count > 0)
            {
                if (item.Mensagens[item.Mensagens.Count - 1].cOsMes_mensagem.Length > 120)
                {
                    mensagem = item.Mensagens[item.Mensagens.Count - 1].cOsMes_mensagem.Substring(0, 119) + "...";
                }
                else
                {
                    mensagem = item.Mensagens[item.Mensagens.Count - 1].cOsMes_mensagem;
                }
            }
            <tr>
                <td><a href="@Url.Content("/Chamado/Ticket/Update/"+item.cOs_id)">@item.cOs_numero</a></td>
                <td>@item.Cliente.cli_nomeFantasia</td>
                <td>@item.Status.cSt_nome</td>
                <td>@item.Categoria.cCa_nome</td>
                <td>@mensagem</td>
            </tr>
        }
    </tbody>
</table>



<script>
    $(function () {
        $(".deletarcliente").click(function () {
            var id = $(this).attr('id');
            var name = $(this).attr('name');
            Confirmacao("Atenção", "Tem certeza que quer remover o cliente " + name, function (retorno) {
                if (retorno)
                    Alerta('Confirmação', 'Cliente removido com sucesso', function(){});
                else
                    Alerta('Cancelado', 'Operação cancelada', function () { });
            })
        })
    })
</script>
